# wx.onLocationChange(function listener)

## 功能说明

监听实时地理位置变化事件。

- **基础库版本**：2.8.1 开始支持（低版本需做兼容处理）。
- **使用限制**：
  - 需结合 `wx.startLocationUpdateBackground` 或 `wx.startLocationUpdate` 使用。
  - **小程序插件不支持**。
  - 微信鸿蒙 OS 版支持。
- **声明要求**：自 2022 年 7 月 14 日后发布的小程序，若使用该接口，必须在 `app.json` 中进行声明（具体规则见官方公告）。
- **权限开通要求**：暂只针对特定类目的小程序开放（详见下方申请开通部分），需在小程序管理后台自助开通接口权限。

## 申请开通（类目限制）

该接口权限有限制，仅对以下类目开放，且需通过类目审核并在后台开通权限。

### 国内主体开放类目

- **电商平台** / **商家自营**：售卖商品线下发货、收货、送货服务；线下商超导览、导航服务。
- **医疗服务**：实际物品/药品接收服务；基于地理位置取号并现场报到、附近医院导航。
- **交通服务**：代驾服务、租车网点导航等。
- **生活服务**：上门服务作业等线下场景。
- **物流服务**：快递/货物收发服务。
- **餐饮服务**：线下送餐服务。
- **工具**：与地理位置相关的服务（如潮汐、海拔、天气查询）。
- **金融-保险**：线下网点预约、取号报到、网点导航。
- **旅游-景区服务**：景区导航、导览服务。
- **政务民生** / **政府主体账号**：提供政务单位相关业务。

### 海外主体开放类目

- **出行与交通**：代驾、租车导航。
- **快递业与邮政**：收发服务。
- **餐饮**：线下送餐。
- **跨境电商**：发货、收货、商超导航。
- **本地服务**：各类商品线下收发货、商超导航。
- **生活服务**：家政、外送等上门作业。

## 参数

### function listener

实时地理位置变化事件的监听函数。

#### 监听函数回调参数 Object res

| 属性 | 类型 | 说明 | 最低基础库版本 |
| :--- | :--- | :--- | :--- |
| latitude | number | 纬度，范围为 -90~90，负数表示南纬。使用 gcj02 国测局坐标系。 | |
| longitude | number | 经度，范围为 -180~180，负数表示西经。使用 gcj02 国测局坐标系。 | |
| speed | number | 速度，单位 m/s。 | |
| accuracy | number | 位置的精确度。 | |
| altitude | number | 高度，单位 m。 | 1.2.0 |
| verticalAccuracy | number | 垂直精度，单位 m（Android 无法获取，返回 0）。 | 1.2.0 |
| horizontalAccuracy | number | 水平精度，单位 m。 | 1.2.0 |

## 返回值

无。

## 示例代码

```javascript
const _locationChangeFn = function(res) {
  console.log('location change', res)
}
wx.onLocationChange(_locationChangeFn)

// 如需取消监听，使用对应的 off 函数
wx.offLocationChange(_locationChangeFn)
```
