# wx.startLocationUpdate(Object object)

## API 基本信息

- **功能**：开启小程序进入前台时接收位置消息。
- **支持版本**：基础库 2.8.0 开始支持，低版本需做兼容处理。
- **调用方式**：支持 Promise 风格调用。
- **用户授权**：需要 `scope.userLocation` 权限。
- **插件支持**：支持，需要小程序基础库版本不低于 2.8.0。

## 功能说明

该接口用于监听小程序在前台运行时的位置变化。

**重要规则：**
自 2022 年 7 月 14 日后发布的小程序，若使用该接口，需要在 `app.json` 中进行声明，否则将无法正常使用。2022年7月14日前发布的小程序不受影响。

## 申请开通条件（类目限制）

该接口暂只针对特定类目的小程序开放，需先通过类目审核，并在小程序管理后台的「开发」-「开发管理」-「接口设置」中自助开通。从 2022 年 7 月 14 日开始，代码审核环节将检测该接口是否已开通。

### 国内主体开放类目包括：

- **电商平台 / 商家自营**：售卖商品线下发货、收货、送货服务、线下商超导览、导航服务。
- **医疗服务**：实际物品/药品接收服务、基于地理位置取号并现场报到、附近医院导航等。
- **交通服务**：代驾服务、租车网点导航等。
- **生活服务**：上门服务作业等线下场景。
- **物流服务**：快递/货物收发服务。
- **餐饮服务**：线下送餐服务。
- **工具**：与地理位置相关的服务（如潮汐、海拔、天气查询）。
- **金融（保险）**：线下网点预约、基于地理位置取号并现场报到、附近网点导航等。
- **旅游（景区服务）**：景区导航、导览服务。
- **政务民生 / 政府主体账号**：提供政务单位相关业务。

### 海外主体开放类目包括：

出行与交通、快递业与邮政、餐饮（外卖点餐）、跨境电商、本地服务、生活服务等（具体应用场景与国内类似）。

## 参数

### Object object

| 属性 | 类型 | 默认值 | 必填 | 说明 |
| :--- | :--- | :--- | :--- | :--- |
| type | string | 'gcj02' | 否 | 指定坐标系类型：<br>`gcj02`：返回可用于 `wx.openLocation` 的坐标<br>`wgs84`：返回 gps 坐标 |
| success | function | | 否 | 接口调用成功的回调函数 |
| fail | function | | 否 | 接口调用失败的回调函数 |
| complete | function | | 否 | 接口调用结束的回调函数（调用成功、失败都会执行） |

## 返回值

该文档页面未直接列出具体的返回值对象结构。根据一般规则：
- 如果回调 `success` 执行，通常表示监听启动成功。
- 位置数据的获取通常通过监听 `wx.onLocationChange` 回调来接收具体的位置信息（经纬度、速度等）。

## 注意事项

1. **权限声明**：获取位置信息需在 `app.json` 中配置地理位置用途说明 (`permission`)。
2. **后台运行**：此 API 仅在**前台**时接收位置消息。如需在后台持续接收位置，请使用 `wx.startLocationUpdateBackground`。

## 示例代码

```javascript
// 1. 开启前台位置监听
wx.startLocationUpdate({
  type: 'gcj02', // 返回可用于 wx.openLocation 的坐标
  success(res) {
    console.log('开启位置监听成功', res)
  },
  fail(err) {
    console.error('开启位置监听失败', err)
  }
})

// 2. 监听位置变化事件（必须搭配使用，否则无法获取数据）
wx.onLocationChange(function(res) {
  console.log('位置发生变化：', res.latitude, res.longitude)
})

// 3. 停止监听（在不需要时调用）
// wx.stopLocationUpdate()
// wx.offLocationChange()
```
